name: Manual - Tag and Release - Only performed on stg branches

on:
    # Manual
    workflow_dispatch:

jobs:
    tag:
        runs-on: macos-latest
        environment: Tag
        
        steps:
        # Check out repository so that the job can access it
        - uses: actions/checkout@v3
        
        - name: Updating CocoaPods repo
        run: pod repo update
        
        - name: Tag
        run: |
            GITHUB_TOKEN=${{ secrets.GITHUB_TOKEN }} sh .github/tag.sh

    push:
        runs-on: macos-latest
        environment: CocoaPods
        needs: tag
        
        steps:
        - run: |
            PODS_USER=${{ secrets.PODS_USER }} PODS_PASS=${{ secrets.PODS_PASS }} sh .github/publish.sh
